# **Trustee 系统使用说明书**
<center>2227405073 姜涛 2227405080 叶子洲 2227405007 秦雨芊</center> 
<center>2025年6月5日</center>

## 1 产品介绍

### 1.1 产品概述
<p style="text-indent:2em">Trustee是一个基于人工智能的智能Windows自动化系统，集成了计算机视觉、自然语言处理和自动化操作技术，为用户提供简单易用的系统自动化解决方案。通过自然语言输入，用户可以轻松实现复杂的系统操作自动化。</p>

### 1.2 主要功能
- **智能操作识别**: 基于AI的屏幕内容理解和操作识别
- **自然语言交互**: 支持自然语言输入，无需编程基础
- **多设备管理**: 统一管理本地和远程设备
- **任务自动化**: 完整的任务生命周期管理
- **可视化界面**: 现代化的Web界面，简单易用

### 1.3 系统特点
- **零编程基础**: 通过自然语言即可操作
- **AI驱动**: 先进的视觉理解和指令解析技术
- **安全可靠**: 完善的权限控制和操作确认机制
- **跨平台**: 支持多种操作系统和设备类型

## 2 系统要求

### 2.1 硬件要求
- **处理器**: Intel Core i3或AMD同等级别处理器
- **内存**: 2GB RAM（推荐4GB或更多）
- **存储空间**: 至少100MB可用磁盘空间
- **网络**: 互联网连接（用于AI服务）

### 2.2 软件要求
- **操作系统**: Windows 10/11（推荐）
- **Python**: 3.8或更高版本
- **浏览器**: Chrome 100+、Firefox 100+、Edge 100+
- **网络要求**: 支持HTTPS访问

### 2.3 可选要求
- **摄像头**: 用于屏幕截图功能
- **麦克风**: 未来版本可能支持语音输入
- **管理员权限**: 某些自动化操作需要管理员权限

## 3 安装与配置

### 3.1 环境准备

#### 3.1.1 Python环境安装
1. 访问Python官网(https://www.python.org/)下载Python 3.8+
2. 运行安装程序，勾选"Add Python to PATH"选项
3. 完成安装后，打开命令提示符验证安装：
```bash
python --version
```

#### 3.1.2 Git工具安装（可选）
<p style="text-indent:2em">如果需要从源码安装，请安装Git工具：</p>
1. 访问Git官网(https://git-scm.com/)下载Git
2. 按照默认选项完成安装

### 3.2 系统安装

#### 3.2.1 获取系统文件
**方法一：从发布包安装**
1. 下载Trustee系统安装包
2. 解压到目标目录（如C:\Trustee）

**方法二：从源码安装**
```bash
git clone <项目地址>
cd trustee
```

#### 3.2.2 安装依赖
<p style="text-indent:2em">在系统目录下执行：</p>
```bash
pip install -r requirements.txt
```

<p style="text-indent:2em">主要依赖包括：</p>
- Flask 2.3+: Web框架
- Pillow: 图像处理
- PyAutoGUI: 自动化操作
- Requests: HTTP请求

### 3.3 初始化配置

#### 3.3.1 数据库初始化
<p style="text-indent:2em">系统首次启动时会自动创建数据库，无需手动操作。</p>

#### 3.3.2 AI服务配置
<p style="text-indent:2em">系统默认使用预配置的AI服务，如需自定义，请修改配置：</p>
```python
# 在api.py中修改AI服务配置
ARK_API_KEY = "your-api-key"
MODEL_NAME = "doubao-1.5-ui-tars"
```

### 3.4 启动系统

#### 3.4.1 启动服务
<p style="text-indent:2em">在系统目录下运行：</p>
```bash
python api.py
```

#### 3.4.2 访问系统
<p style="text-indent:2em">打开浏览器，访问：</p>
```
http://localhost:5000
```

#### 3.4.3 默认账户
- **用户名**: admin
- **密码**: admin

<center class ='img'>
<!-- 登录界面截图占位 -->
<img src="../pic/login_screen.png" width="60%"/>
</center>
<p align="center">图1 系统登录界面</p>

## 4 快速入门

### 4.1 首次登录

#### 4.1.1 系统登录
1. 打开浏览器，访问系统地址
2. 输入用户名和密码
3. 点击"登录"按钮
4. 系统将跳转到主界面

#### 4.1.2 界面介绍
<p style="text-indent:2em">登录成功后，您将看到系统主界面，包含以下主要区域：</p>
- **导航栏**: 包含各功能模块的快捷入口
- **设备管理**: 管理和监控设备状态
- **任务管理**: 创建和执行自动化任务
- **AI工作室**: 进行智能分析和操作
- **历史记录**: 查看操作历史和结果

<center class ='img'>
<!-- 主界面截图占位 -->
<img src="../pic/main_interface.png" width="80%"/>
</center>
<p align="center">图2 系统主界面</p>

### 4.2 添加设备

#### 4.2.1 设备添加步骤
1. 点击导航栏中的"设备管理"
2. 点击"添加设备"按钮
3. 填写设备信息：
   - 设备名称（如"我的电脑"）
   - 设备类型（本地/远程）
   - IP地址（远程设备需要）
   - 操作系统信息
4. 点击"保存"完成添加

#### 4.2.2 设备测试
<p style="text-indent:2em">添加设备后，建议进行连接测试：</p>
1. 在设备列表中找到新添加的设备
2. 点击"测试连接"按钮
3. 系统将检测设备连通性
4. 查看测试结果，确保设备可正常使用

<center class ='img'>
<!-- 设备管理界面截图占位 -->
<img src="../pic/device_management.png" width="80%"/>
</center>
<p align="center">图3 设备管理界面</p>

### 4.3 创建第一个任务

#### 4.3.1 基本任务创建
1. 点击"任务管理"进入任务页面
2. 点击"创建任务"按钮
3. 填写任务信息：
   - 任务名称：描述性的任务名称
   - 自然语言指令：如"打开记事本并输入Hello World"
   - 目标设备：选择执行任务的设备
4. 点击"创建"保存任务

#### 4.3.2 任务执行
1. 在任务列表中找到刚创建的任务
2. 点击"执行"按钮
3. 系统将开始分析和执行任务
4. 观察任务状态变化和执行进度
5. 查看执行结果和日志

<center class ='img'>
<!-- 任务创建界面截图占位 -->
<img src="../pic/task_creation.png" width="80%"/>
</center>
<p align="center">图4 任务创建界面</p>

### 4.4 使用AI工作室

#### 4.4.1 截图分析
1. 点击"AI工作室"进入分析页面
2. 准备需要分析的屏幕截图
3. 点击"上传截图"或"实时截图"
4. 在指令输入框中输入操作要求
5. 点击"分析"按钮开始AI分析

#### 4.4.2 查看分析结果
<p style="text-indent:2em">AI分析完成后，您将看到：</p>
- **识别结果**: AI识别的界面元素
- **操作坐标**: 精确的点击坐标位置
- **生成代码**: 可执行的PyAutoGUI代码
- **置信度**: AI分析结果的可信度

#### 4.4.3 执行操作
<p style="text-indent:2em">您可以选择：</p>
- **演练模式**: 预览操作但不实际执行
- **直接执行**: 立即执行分析得到的操作
- **保存为任务**: 将操作保存为可重复使用的任务

<center class ='img'>
<!-- AI工作室界面截图占位 -->
<img src="../pic/ai_studio.png" width="80%"/>
</center>
<p align="center">图5 AI工作室界面</p>

## 5 功能详解

### 5.1 用户管理

#### 5.1.1 账户管理
<p style="text-indent:2em">系统支持用户注册和登录功能：</p>
- **用户注册**: 创建新的用户账户
- **密码修改**: 修改登录密码
- **个人信息**: 管理个人基本信息
- **权限设置**: 管理用户操作权限

#### 5.1.2 会话管理
<p style="text-indent:2em">系统提供安全的会话管理：</p>
- **自动登录**: 记住登录状态
- **会话超时**: 长时间不活动自动登出
- **并发控制**: 支持多设备同时登录
- **安全登出**: 安全清理会话信息

### 5.2 设备管理详解

#### 5.2.1 设备类型
**本地设备**
- 自动检测本地计算机信息
- 直接在本机执行操作
- 无需网络连接

**远程设备**
- 通过网络连接的设备
- 需要在目标设备安装客户端
- 支持远程屏幕查看和控制

#### 5.2.2 设备监控
<p style="text-indent:2em">系统提供实时的设备状态监控：</p>
- **在线状态**: 显示设备是否在线
- **性能指标**: 监控CPU、内存使用情况
- **连接质量**: 显示网络连接质量
- **历史数据**: 记录设备状态历史

#### 5.2.3 设备操作
- **远程截图**: 获取设备屏幕截图
- **系统信息**: 查看设备详细信息
- **文件传输**: 支持文件上传下载（规划中）
- **远程控制**: 远程桌面控制功能

### 5.3 任务管理详解

#### 5.3.1 任务类型
**手动任务**
- 用户手动创建和执行
- 支持复杂的操作序列
- 可以包含条件判断和循环

**定时任务**
- 按照设定的时间自动执行
- 支持单次和周期性执行
- 可设置执行条件和触发器

**触发任务**
- 基于特定事件触发执行
- 支持文件变化、网络事件等触发器
- 可以链式触发多个任务

#### 5.3.2 任务状态
- **pending**: 等待执行
- **running**: 正在执行
- **paused**: 暂停执行
- **completed**: 执行完成
- **failed**: 执行失败

#### 5.3.3 任务监控
<p style="text-indent:2em">系统提供详细的任务执行监控：</p>
- **实时进度**: 显示当前执行进度
- **步骤详情**: 查看每个执行步骤
- **错误信息**: 详细的错误日志
- **执行统计**: 任务执行时间统计

### 5.4 AI工作室详解

#### 5.4.1 图像识别功能
**UI元素识别**
- 按钮、输入框、菜单等界面元素
- 文本内容识别和提取
- 图标和图像识别
- 窗口和对话框识别

**坐标定位**
- 精确的像素级坐标定位
- 支持不同分辨率自动适配
- 相对坐标和绝对坐标转换
- 多屏幕环境支持

#### 5.4.2 自然语言处理
**指令理解**
- 中文自然语言指令解析
- 操作意图识别和提取
- 参数和条件解析
- 复杂指令分解

**代码生成**
- 自动生成PyAutoGUI代码
- 支持多种操作类型
- 包含错误处理逻辑
- 可读性和可维护性优化

#### 5.4.3 操作执行
**执行模式**
- 演练模式：预览但不执行
- 实际执行：直接执行操作
- 调试模式：逐步执行并暂停
- 批量执行：同时执行多个操作

**安全控制**
- 操作前确认提示
- 紧急停止功能
- 操作范围限制
- 敏感操作保护

## 6 高级功能

### 6.1 批量操作

#### 6.1.1 批量任务创建
<p style="text-indent:2em">系统支持批量创建相似任务：</p>
1. 创建一个模板任务
2. 导入数据文件（CSV、Excel等）
3. 系统自动生成多个任务
4. 批量执行所有任务

#### 6.1.2 批量设备管理
<p style="text-indent:2em">可以同时管理多个设备：</p>
- 批量添加设备
- 批量状态检查
- 批量配置更新
- 批量操作执行

### 6.2 自定义脚本

#### 6.2.1 脚本编写
<p style="text-indent:2em">高级用户可以编写自定义脚本：</p>
```python
# 自定义脚本示例
import pyautogui
import time

def custom_operation():
    # 等待2秒
    time.sleep(2)
    # 点击指定位置
    pyautogui.click(100, 200)
    # 输入文本
    pyautogui.typewrite('Hello Trustee!')
```

#### 6.2.2 脚本导入
<p style="text-indent:2em">支持导入现有的Python脚本：</p>
1. 将脚本文件放入scripts目录
2. 在系统中注册脚本
3. 通过任务管理调用脚本
4. 支持脚本参数传递

### 6.3 数据导入导出

#### 6.3.1 任务数据导出
<p style="text-indent:2em">支持将任务数据导出为多种格式：</p>
- **JSON格式**: 完整的任务配置信息
- **CSV格式**: 任务统计和报表数据
- **Excel格式**: 详细的任务执行报告
- **XML格式**: 标准化的数据交换格式

#### 6.3.2 系统配置导入
<p style="text-indent:2em">支持从配置文件导入系统设置：</p>
- 设备配置批量导入
- 用户权限批量设置
- 任务模板批量创建
- 系统参数批量配置

### 6.4 API接口使用

#### 6.4.1 REST API
<p style="text-indent:2em">系统提供完整的REST API接口：</p>
```http
# 获取任务列表
GET /api/tasks

# 创建新任务
POST /api/tasks
{
  "task_name": "test task",
  "natural_language_input": "click button"
}

# 执行任务
POST /api/tasks/{task_id}/execute
```

#### 6.4.2 Webhook支持
<p style="text-indent:2em">支持通过Webhook接收外部事件：</p>
- 任务完成通知
- 系统状态变化通知
- 错误和异常通知
- 自定义事件通知

## 7 故障排除

### 7.1 常见问题

#### 7.1.1 安装问题

**问题**: Python依赖安装失败
**解决方案**:
1. 检查Python版本是否符合要求
2. 使用管理员权限运行命令提示符
3. 更新pip到最新版本：`python -m pip install --upgrade pip`
4. 逐个安装依赖包：`pip install flask pillow pyautogui`

**问题**: 系统启动失败
**解决方案**:
1. 检查端口5000是否被占用
2. 检查防火墙是否阻止了连接
3. 查看错误日志文件：`trustee.log`
4. 尝试使用不同端口启动：`python api.py --port 8080`

#### 7.1.2 功能问题

**问题**: AI分析返回错误
**解决方案**:
1. 检查网络连接是否正常
2. 确认AI服务配置正确
3. 检查上传的图片格式和大小
4. 查看详细的错误信息

**问题**: 任务执行失败
**解决方案**:
1. 检查目标设备是否在线
2. 确认设备有足够的权限执行操作
3. 检查任务指令是否正确
4. 查看任务执行日志

#### 7.1.3 性能问题

**问题**: 系统响应缓慢
**解决方案**:
1. 检查系统资源使用情况
2. 清理历史数据和临时文件
3. 重启系统服务
4. 检查数据库文件大小

**问题**: 内存占用过高
**解决方案**:
1. 减少同时处理的任务数量
2. 优化图片处理大小
3. 定期重启服务
4. 检查是否有内存泄漏

### 7.2 错误代码说明

| 错误代码 | 错误描述 | 解决方案 |
|----------|----------|----------|
| 1001 | 用户名或密码错误 | 检查登录凭据 |
| 1002 | 用户未登录 | 重新登录系统 |
| 1003 | 权限不足 | 联系管理员获取权限 |
| 2001 | 设备不存在 | 检查设备配置 |
| 2002 | 设备连接失败 | 检查网络连接 |
| 3001 | 任务不存在 | 检查任务ID |
| 3002 | 任务执行失败 | 查看详细错误日志 |
| 4001 | AI分析失败 | 检查图片和指令 |
| 4002 | 图片格式不支持 | 使用支持的图片格式 |

### 7.3 日志查看

#### 7.3.1 系统日志
<p style="text-indent:2em">系统日志文件位置：</p>
- **主日志**: `trustee.log`
- **错误日志**: `error.log`
- **访问日志**: `access.log`
- **AI日志**: `ai_service.log`

#### 7.3.2 日志级别
- **DEBUG**: 详细的调试信息
- **INFO**: 一般信息记录
- **WARNING**: 警告信息
- **ERROR**: 错误信息
- **CRITICAL**: 严重错误信息

#### 7.3.3 日志分析
<p style="text-indent:2em">查看日志的常用命令：</p>
```bash
# 查看最新100行日志
tail -n 100 trustee.log

# 查看错误日志
grep "ERROR" trustee.log

# 实时监控日志
tail -f trustee.log
```

### 7.4 技术支持

#### 7.4.1 获取帮助
- **在线文档**: 访问系统帮助页面
- **社区论坛**: 在用户社区提问
- **技术支持**: 联系技术支持团队
- **bug报告**: 通过GitHub提交问题

#### 7.4.2 联系信息
- **邮箱**: support@trustee.com
- **电话**: 400-123-4567
- **QQ群**: 123456789
- **微信**: trustee_support

## 8 安全隐私

### 8.1 数据安全

#### 8.1.1 数据加密
<p style="text-indent:2em">系统采用多层数据加密保护：</p>
- 传输加密：HTTPS协议保护数据传输
- 存储加密：敏感数据本地加密存储
- 访问加密：用户认证和权限控制
- 通信加密：API接口加密通信

#### 8.1.2 隐私保护
<p style="text-indent:2em">系统严格保护用户隐私：</p>
- 最小化数据收集原则
- 本地数据处理，减少云端传输
- 用户数据不用于其他目的
- 支持数据删除和导出

### 8.2 访问控制

#### 8.2.1 用户权限
<p style="text-indent:2em">系统实施严格的权限控制：</p>
- 基于角色的访问控制(RBAC)
- 功能级别的权限管理
- 操作审计和日志记录
- 异常访问检测和告警

#### 8.2.2 操作安全
<p style="text-indent:2em">自动化操作安全保障：</p>
- 操作前用户确认
- 敏感操作额外验证
- 操作范围和权限限制
- 紧急停止和回滚机制

### 8.3 网络安全

#### 8.3.1 网络防护
<p style="text-indent:2em">系统内置多种网络安全防护：</p>
- 防止SQL注入攻击
- 防止XSS跨站脚本攻击
- 防止CSRF跨站请求伪造
- 输入验证和输出过滤

#### 8.3.2 通信安全
<p style="text-indent:2em">确保通信过程的安全性：</p>
- TLS/SSL加密通信
- API接口认证和授权
- 请求签名和验证
- 网络访问控制列表

## 9 性能优化

### 9.1 系统优化

#### 9.1.1 启动优化
<p style="text-indent:2em">提升系统启动速度：</p>
```bash
# 使用优化参数启动
python api.py --optimize

# 使用多进程模式
python api.py --workers 4

# 预加载常用模块
python api.py --preload
```

#### 9.1.2 内存优化
<p style="text-indent:2em">优化内存使用：</p>
- 及时释放不用的图像对象
- 使用内存池管理大对象
- 定期执行垃圾回收
- 监控内存使用情况

#### 9.1.3 数据库优化
<p style="text-indent:2em">提升数据库性能：</p>
```sql
-- 创建索引优化查询
CREATE INDEX idx_tasks_status ON tasks(status);
CREATE INDEX idx_tasks_user_id ON tasks(user_id);

-- 定期清理历史数据
DELETE FROM executions WHERE created_at < date('now', '-30 days');

-- 优化数据库文件
VACUUM;
```

### 9.2 网络优化

#### 9.2.1 连接优化
<p style="text-indent:2em">优化网络连接性能：</p>
- 启用连接池
- 使用长连接
- 压缩传输数据
- 启用缓存机制

#### 9.2.2 并发优化
<p style="text-indent:2em">提升并发处理能力：</p>
- 使用异步处理
- 实现任务队列
- 优化线程池配置
- 避免阻塞操作

### 9.3 AI性能优化

#### 9.3.1 图像优化
<p style="text-indent:2em">优化图像处理性能：</p>
```python
# 图像压缩优化
def optimize_image(image_path, max_size=(1920, 1080)):
    with Image.open(image_path) as img:
        img.thumbnail(max_size, Image.Resampling.LANCZOS)
        # 压缩质量设置
        img.save(output_path, optimize=True, quality=85)
```

#### 9.3.2 缓存策略
<p style="text-indent:2em">实施智能缓存策略：</p>
- 缓存AI分析结果
- 缓存常用的操作代码
- 缓存设备状态信息
- 实现缓存失效机制

## 10 维护和支持

### 10.1 日常维护

#### 10.1.1 数据备份
<p style="text-indent:2em">定期备份重要数据：</p>
```bash
# 备份数据库
cp database/trustee.db backup/trustee_$(date +%Y%m%d).db

# 备份配置文件
cp -r config/ backup/config_$(date +%Y%m%d)/

# 备份日志文件
cp *.log backup/logs_$(date +%Y%m%d)/
```

#### 10.1.2 系统清理
<p style="text-indent:2em">定期清理系统文件：</p>
- 清理临时截图文件
- 删除过期的任务记录
- 清理系统日志文件
- 压缩和归档历史数据

#### 10.1.3 性能监控
<p style="text-indent:2em">监控系统运行状态：</p>
- 检查系统资源使用情况
- 监控任务执行成功率
- 分析响应时间趋势
- 检查错误和异常情况

### 10.2 版本更新

#### 10.2.1 更新检查
<p style="text-indent:2em">检查系统更新：</p>
1. 访问官方网站查看最新版本
2. 阅读更新日志和改进内容
3. 评估更新对现有功能的影响
4. 制定更新计划和回滚方案

#### 10.2.2 更新步骤
<p style="text-indent:2em">系统更新流程：</p>
1. 备份当前系统和数据
2. 下载新版本安装包
3. 停止当前运行的服务
4. 安装新版本系统
5. 迁移配置和数据
6. 启动服务并验证功能

### 10.3 扩展功能

#### 10.3.1 插件开发
<p style="text-indent:2em">开发自定义插件：</p>
```python
# 插件开发示例
class CustomPlugin:
    def __init__(self):
        self.name = "Custom Plugin"
        self.version = "1.0.0"
    
    def execute(self, params):
        # 插件功能实现
        pass
    
    def register(self):
        # 注册插件到系统
        pass
```

#### 10.3.2 集成其他系统
<p style="text-indent:2em">与其他系统集成：</p>
- 企业内部系统集成
- 第三方服务API集成
- 数据库系统集成
- 监控系统集成

## 11 附录

### 11.1 快捷键参考

| 功能 | 快捷键 | 说明 |
|------|--------|------|
| 刷新页面 | F5 | 刷新当前页面 |
| 新建任务 | Ctrl + N | 快速创建新任务 |
| 保存设置 | Ctrl + S | 保存当前设置 |
| 搜索 | Ctrl + F | 页面内搜索 |
| 全屏显示 | F11 | 全屏模式切换 |
| 帮助 | F1 | 打开帮助文档 |

### 11.2 支持的文件格式

**图片格式**
- PNG: 推荐格式，支持透明背景
- JPEG/JPG: 常用格式，压缩比高
- BMP: 无损格式，文件较大
- GIF: 支持动画，但不推荐用于截图

**数据格式**
- JSON: API数据交换格式
- CSV: 批量数据导入导出
- Excel: 报表和统计数据
- XML: 标准化数据格式

### 11.3 系统限制

#### 11.3.1 技术限制
- 最大图片尺寸: 10MB
- 最大任务数量: 1000个/用户
- 最大设备数量: 50个/用户
- 最大并发任务: 5个

#### 11.3.2 功能限制
- 仅支持Windows系统自动化
- AI分析需要网络连接
- 某些系统操作需要管理员权限
- 复杂界面识别准确率受限

### 11.4 常用命令参考

```bash
# 启动服务
python api.py

# 指定端口启动
python api.py --port 8080

# 调试模式启动
python api.py --debug

# 检查系统状态
python check_system.py

# 备份数据
python backup.py --type all

# 清理缓存
python cleanup.py --cache

# 运行测试
python -m pytest tests/

# 查看版本信息
python api.py --version
```

### 11.5 联系我们

#### 11.5.1 开发团队
- **项目负责人**: 姜涛 (jiangtao@trustee.com)
- **技术架构**: 叶子洲 (yezizhou@trustee.com)  
- **UI设计**: 秦雨芊 (qinyuqian@trustee.com)

#### 11.5.2 技术支持
- **官方网站**: https://www.trustee.com
- **文档中心**: https://docs.trustee.com
- **GitHub**: https://github.com/trustee-team/trustee
- **技术论坛**: https://forum.trustee.com

#### 11.5.3 反馈渠道
- **Bug报告**: issues@trustee.com  
- **功能建议**: feedback@trustee.com
- **商务合作**: business@trustee.com
- **媒体联系**: media@trustee.com

---

<p style="text-align:center;font-size:14px;color:#666;">
© 2025 Trustee Team. All rights reserved.<br/>
本文档最后更新时间：2025年6月5日<br/>
版本号：v1.0.0
</p> 